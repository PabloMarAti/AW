var connection = require("Conexion");

module.exports = LeerRolJugador;

function LeerRolJugador(partida, usuario, callback) {
    var conexion = connection.getConexion();
    if (callback === undefined) {
        callback = function () {};
    }
    conexion.connect(function (err) {
        var sql = "select partidas.ID as partida , usuario.ID as user from partidas,usuario where partidas.Nombre = ? and ? = usuario.Nombre_usuario;";

        conexion.query(sql, [partida, usuario], function (err, resultado) {
            if (!err) {
                var ID_partida = resultado[0].partida;
                var ID_usuario = resultado[0].user;
                sql = "select Rol " +
                        "from juega " +
                        "where ID_Partida = ? and ID_Usuario = ?;";

                conexion.query(sql, [ID_partida, ID_usuario], function (err, resultado) {
                    if (!err) {
                        callback(null, resultado[0].Rol);
                    } else {
                        callback(err);
                    }
                    conexion.end();
                });
            }
        });

    });
}